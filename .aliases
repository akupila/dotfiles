#!/bin/bash

alias g='git'

# Git stuff
alias gti="git"
alias gs="git status"
alias gd="git diff"
alias gds="git diff --staged"
# log
alias gl="git l"
# log with master
alias glm="git l master head"
# log all
alias gla="git ll --all"
alias glr="git rl"
alias gb="git for-each-ref --sort=-committerdate refs/heads/ --format='%(HEAD) %(color:green)%(refname:short)%(color:reset) - %(color:yellow)%(objectname:short)%(color:reset) - %(contents:subject) - %(authorname) %(color:dim)(%(committerdate:relative))%(color:reset)'"
alias gp="git p"

rebaseStatus() {
	if [ ! -d ".git" ]; then
		echo "Must be in a git repo"
		return 1
	fi

	local next=`cat .git/rebase-apply/next`
	local last=`cat .git/rebase-apply/last`
	local onto=`cat .git/rebase-apply/onto`
	local orig=`cat .git/rebase-apply/original-commit`
	local o_head=`cat .git/rebase-apply/orig-head`
	echo "Rebase status $next/$last"
	printf "\033[0;90m"
	git rev-list --abbrev-commit --pretty=oneline $orig..$o_head | tail -n 3
	printf "\033[0;33m"
	git rev-list --abbrev-commit --format=oneline --max-count=1 $orig
	printf "\033[0;92m"
	git rev-list --abbrev-commit --format=oneline --max-count=1 $orig^
	printf "\033[0;37m"
	git rev-list --abbrev-commit --pretty=oneline --max-count=2 $orig^^
	printf "\033[0;0m"

}
alias gr=rebaseStatus || { echo "No rebase in progress?" }
# alias gr="echo 'Rebase status \\`cat .git/rebase-apply/next\\`/$last' && printf \"\033[0;90m\" && git rev-list --pretty=oneline $orig..$o_head | tail -n 3 && printf \"\033[0;92m\" && git rev-list --format=oneline --max-count=1 $orig && printf \"\033[0m\" && git rev-list --pretty=oneline --max-count=3 $orig^"


# Replace vim with nvim

alias vim="nvim"

# Lazy typing 

alias k="kubectl"
alias e="etcdctl"

# Flow

# go watch flow
alias gwf="find src -name '*.js' -o -name '.jsx' -not -path 'node_modules' | entr -c flow"

# general

alias pwdc="pwd | pbcopy && echo path \($(pwd)\) copied to clipboard"


# Fix crappy wifi by restarting it (after sleep)

alias fixwifi="echo \"Restarting wifi..\" && networksetup -setairportpower en0 off; networksetup -setairportpower en0 on"
